var session=new getSessionData,plugins={referral:!1},mole=function(e,i){switch(e){case"setDomain":session.domain=i;break;case"setNames":insertData.prototype.names=i;break;case"setQueryNames":insertData.prototype.queryStringNames=i;case"plugin":switch(i){case"referral":plugins.referral=!0}break;case"saveSession":(session.new_user()||session.new_session())&&saveData();break;case"processForms":"marketo"==i&&(insertData.prototype.forms_e=MktoForms2.allForms(),insertData.prototype.addFields=function(e,i){e.addHiddenFields(i)}),(new insertData).init("forms");break;case"addQueryStrings":insertData.prototype.ele=i,(new insertData).init("queryStrings")}};function getSessionData(){this.domain=this.domain||window.location.hostname.replace("www.",""),this.timestamp=(new Date).getTime(),this.referrer_url=function(e){var i=document.referrer,n=i.split("/")[2];return void 0!==i&&"undefined"!==i&&""!==i&&-1==i.indexOf(this.domain)&&(e?n:i)},this.timeout=18e5,this.cookie_expires=function(){var e=new Date;return e.setTime(e.getTime()+31536e6),"expires="+e.toUTCString()},this.organic_sources=["google","daum","eniro","naver","yahoo","msn","bing","aol","lycos","ask","altavista","netscape","cnn","about","mamma","alltheweb","voila","virgilio","live","baidu","alice","yandex","najdi","mama","seznam","search","wirtulana polska","onetcenter","szukacz","yam","pchome","kvasir","sesam","ozu","terra","mynet","ekolay","rambler"],this.social_sources=["facebook","pinterest","twitter","buzzfeed","linkedin","blogger","blogspot","reddit","tumblr","stumbleupon","tinyurl","polyvore","youtube","yelp","cafemom","flickr","paper.li","wordpress","getpocket","weebly","delicious","netvibes","plurk","typepad","vk","allvoices","badoo","disqus","livefyre","d.hatena","t.co","plus.google.com","plus.url.google.com","bookmarks.yahoo.com","answers.yahoo.com"],this.intersection=function(e,i){for(var n=0;n<i.length;n++)if(-1!=e.indexOf(i[n]))return!0;return!1},this.query_string=function(e,i){return void 0!==i&&""!==i&&"undefined"!==i&&!1!==i||(i=this.landing_page()),-1!=i.indexOf("?")&&-1!=i.indexOf(e,i.indexOf("?"))&&(-1!=i.indexOf("&",i.search(e))?decodeURIComponent(i.substring(i.indexOf(e,i.indexOf("?"))+e.length+1,i.indexOf("&",i.search(e)))):decodeURIComponent(i.substring(i.indexOf(e,i.indexOf("?"))+e.length+1)))},this.default_medium=function(){return!1===this.referrer_url()?"none":""!=this.query_string("gclid")&&0!=this.query_string("gclid")?"paid":this.intersection(this.social_sources,this.referrer_url(!0).split("."))?"social":this.intersection(this.organic_sources,this.referrer_url(!0).split("."))?"organic":"referral"},this.default_source=function(){return"none"==this.default_medium()?"direct":this.referrer_url(!0)},this.default_term=function(){return this.query_string("q",this.referrer_url(!1))?this.query_string("q",this.referrer_url(!1)):"not provided"},this.landing_page=function(){return window.location.href},this.new_user=function(){return!this.readCookie("_orig_data")},this.new_session=function(){var e=this.readCookie("_conv_data");return!!e&&this.timestamp-e.timestamp>this.timeout},this.readCookie=function(e){for(var i=document.cookie.split(";"),n=0;n<i.length;n++){var t;if((t=0==i[n].indexOf(" ")?i[n].substring(1):i[n]).indexOf(e)>=0)return JSON.parse(t.substring(e.length+1))}return!1}}function saveData(){var e={timestamp:session.timestamp,source:"",medium:"",content:session.query_string("utm_content"),campaign:session.query_string("utm_campaign"),term:"",landing_page:session.landing_page()};return plugins.referral&&(e.referral=session.referrer_url(!1)),session.query_string("utm_source")?e.source=session.query_string("utm_source"):e.source=session.default_source(),session.query_string("utm_medium")?e.medium=session.query_string("utm_medium"):e.medium=session.default_medium(),session.query_string("utm_term")?e.term=session.query_string("utm_term"):e.term=session.default_term(),session.new_user()?(document.cookie="_conv_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax",document.cookie="_orig_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax"):session.new_session()&&(document.cookie="_conv_data="+JSON.stringify(e)+";"+session.cookie_expires()+"; path=/;domain=."+session.domain+"; SameSite=Lax"),JSON.stringify(e)}function insertData(){this.forms_e=this.forms_e||document.getElementsByTagName("form"),this.ele=this.ele||document.getElementsByTagName("a"),this.names=this.names||{converting_timestamp:"converting_timestamp",converting_source:"converting_source",converting_medium:"converting_medium",converting_content:"converting_content",converting_campaign:"converting_campaign",converting_term:"converting_term",converting_landing_page:"converting_landing_page",converting_referral:"converting_referral",original_timestamp:"original_timestamp",original_source:"original_source",original_medium:"original_medium",original_content:"original_content",original_campaign:"original_campaign",original_term:"original_term",original_landing_page:"original_landing_page",original_referral:"original_referral"},this.queryStringNames=this.queryStringNames||{converting_timestamp:"converting_timestamp",converting_source:"converting_source",converting_medium:"converting_medium",converting_content:"converting_content",converting_campaign:"converting_campaign",converting_term:"converting_term",converting_landing_page:"converting_landing_page",converting_referral:"converting_referral",original_timestamp:"original_timestamp",original_source:"original_source",original_medium:"original_medium",original_content:"original_content",original_campaign:"original_campaign",original_term:"original_term",original_landing_page:"original_landing_page",original_referral:"original_referral"},this.conv=session.readCookie("_conv_data"),this.orig=session.readCookie("_orig_data"),this.init=function(e){if("forms"==e){if(this.conv&&this.orig)r=this.compileObj(this.conv,this.orig,this.names);else var i=saveData(),n=JSON.parse(i),t=JSON.parse(i),r=this.compileObj(n,t,this.names);for(var s=0;s<this.forms_e.length;s++)this.addFields(this.forms_e[s],r)}if("queryStrings"==e){r=this.compileObj(this.conv,this.orig,this.queryStringNames);for(var o in this.ele)if(this.ele[o].nodeType)this.queryString(this.ele[o],o,r);else for(var a=0;a<this.ele[o].length;a++)if(this.ele[o][a].nodeType)this.queryString(this.ele[o][a],o,r);else for(s=0;s<this.ele[o][a].length;s++)this.queryString(this.ele[o][a][s],o,r)}},this.compileObj=function(e,i,n){var t={};for(var r in e.timestamp=this.convertTimestamp(e.timestamp),i.timestamp=this.convertTimestamp(i.timestamp),e)e["converting_"+r]=e[r],delete e[r];for(var r in i)i["original_"+r]=i[r],delete i[r];for(var r in e)if(e[r])for(var s in n)r==s&&(t[n[s]]=e[r]);for(var r in i)if(i[r])for(var s in n)r==s&&(t[n[s]]=i[r]);return t},this.convertTimestamp=function(e){var i=new Date(e);return i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()},this.addFields=this.addFields||function(e,i){for(var n in i)if(e.elements.namedItem(n))e.elements.namedItem(n).value=i[n];else{var t=document.createElement("input");t.type="hidden",t.name=n,t.value=i[n],e.appendChild(t)}},this.queryString=this.queryString||function(e,i,n){if(void 0!==e&&null!=e.getAttribute(i)){var t="",r=e.getAttribute(i);-1==r.indexOf("?")?r+="?":r.indexOf("?")!=r.length-1&&(r+="&");for(var s=Object.keys(n),o=0,a=s.length;o<a;o++){var m=encodeURIComponent(s[o]),g=encodeURIComponent(n[m]);if(0!=session.query_string(m,r)){var c=r.indexOf(m);if(r.indexOf("&",c)>-1)var l=r.indexOf("&",c);else l=null;var u=r.substring(c,l),d=t+m+"="+g;r=r.replace(u,d)}else t=t+encodeURIComponent(m)+"="+encodeURIComponent(g),o!=a-1&&(t+="&")}e.setAttribute(i,r+t)}}}